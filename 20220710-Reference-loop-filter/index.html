<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="AD8606 amplifier I constructe a noninverting amplifier per the art of electronics basic circuit:
![[Pasted image 20220710120248.png]]
And it looks like this:"><title>Harry dB notes</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://Oscilllator.github.io/quartz//icon.png><link href=https://Oscilllator.github.io/quartz/styles.708c2658f93e3a9d323a1f9fded8f4b2.min.css rel=stylesheet><link href=https://Oscilllator.github.io/quartz/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://Oscilllator.github.io/quartz/js/darkmode.9b46d81b9b161bfac149d66dfa6b3812.min.js></script>
<script src=https://Oscilllator.github.io/quartz/js/util.9825137f5e7825e8553c68ce39ac9e44.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script src=https://Oscilllator.github.io/quartz/js/popover.9b72b70bd35617d0635e9d15463662b2.min.js></script>
<script src=https://Oscilllator.github.io/quartz/js/code-title.b35124ad8db0ba37162b886afb711cbc.min.js></script>
<script src=https://Oscilllator.github.io/quartz/js/clipboard.c20857734e53a3fb733b7443879efa61.min.js></script>
<script src=https://Oscilllator.github.io/quartz/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const BASE_URL="https://Oscilllator.github.io/quartz/",fetchData=Promise.all([fetch("https://Oscilllator.github.io/quartz/indices/linkIndex.b3259f812ed133e49589f69cf23d7208.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://Oscilllator.github.io/quartz/indices/contentIndex.a393949788e96537f9a3c222ca3be8cf.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://Oscilllator.github.io/quartz",!0,!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://Oscilllator.github.io/quartz",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'â€™':"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/Oscilllator.github.io\/quartz\/js\/router.9d4974281069e9ebb189f642ae1e3ca2.min.js"
    attachSPARouting(init, render)
  </script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-XYFD95KB4J"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XYFD95KB4J",{anonymize_ip:!1})}</script><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://Oscilllator.github.io/quartz/js/full-text-search.24827f874defbbc6d529926cbfcfb493.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://Oscilllator.github.io/quartz/>Harry dB notes</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><p class=meta>Last updated
Unknown
<a href=https://github.com/jackyzha0/quartz/tree/hugo/content/20220710%20Reference%20loop%20filter.md rel=noopener>Edit Source</a></p><ul class=tags></ul><aside class=mainTOC><details><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#performance>Performance</a><ol><li><a href=#input-vs-output-voltage>Input vs output voltage</a></li></ol></li><li><a href=#nonlinearity>Nonlinearity</a></li><li><a href=#noninverting-amplifier-performance>Noninverting amplifier performance</a></li><li><a href=#diff-amp-performance>Diff amp performance</a><ol><li><a href=#the-parable-of-the-cable>The parable of the cable</a></li></ol></li><li><a href=#pll-performance-with-diff-amp>PLL performance with diff amp</a><ol><li><a href=#damping>Damping:</a></li></ol></li></ol></nav></details></aside><a href=#ad8606-amplifier><h1 id=ad8606-amplifier><span class=hanchor arialabel=Anchor># </span>AD8606 amplifier</h1></a><p>I constructe a noninverting amplifier per the art of electronics basic circuit:</p><p><img src="/quartz/Pasted image 20220710120248.png" width=auto></p><p>And it looks like this:</p><p><img src="/quartz/Pasted image 20220710120455.png" width=auto></p><p>Works great.
With this amplifier I can get the PLL to lock with a whopping 1.5Vpp input, up from the previous [410mV](<a href=/quartz/20220701-Inductance-measurements#744b71 rel=noopener class=internal-link data-src=/quartz/20220701-Inductance-measurements>20220701 Inductance measurements</a>). I think this is satisfactory for the overall design. You can see that the VCO (CH2) is close to its limit:</p><p><img src="/quartz/Pasted image 20220710120750.png" width=auto></p><p>Any higher frequency and it would stop oscillating entirely.
CH3 is the input to the VCO. Notice how it requires an offset. The amount of offset required increased with the modulation depth. This seems like it could be to do with maintaining a more constant % modulation.</p><a href=#performance><h2 id=performance><span class=hanchor arialabel=Anchor># </span>Performance</h2></a><p>~~Here are the performance stats. These were measured with a ramp waveform of amplitude 1.6V:</p><p><img src="/quartz/Pasted image 20220710142656.png" width=auto></p><a href=#input-vs-output-voltage><h3 id=input-vs-output-voltage><span class=hanchor arialabel=Anchor># </span>Input vs output voltage</h3></a><p><img src="/quartz/Pasted image 20220710141906.png" width=auto></p><p>Over a MHz of swing there - Noice.</p><a href=#nonlinearity><h2 id=nonlinearity><span class=hanchor arialabel=Anchor># </span>Nonlinearity</h2></a><p><img src="/quartz/Pasted image 20220710142118.png" width=auto></p><p>Interesting difference in the response on the ramp up vs ramp down. And the wiggles on the ramp up seem to pretty persistent - you can change the input waveform frequency and amplitude, and get much the same response.~~
Actually all of the above is garbage cause I was not probing the proper input. Whatever, it looks good to me.
On to measuring the actual amplifier.</p><a href=#noninverting-amplifier-performance><h2 id=noninverting-amplifier-performance><span class=hanchor arialabel=Anchor># </span>Noninverting amplifier performance</h2></a><p><img src="/quartz/Pasted image 20220710143413.png" width=auto></p><p>Lovely. So it looks like the closer to the perfect amplifier it is, the better. From previous testing though I know that more gain than this is deleterious.</p><a href=#diff-amp-performance><h2 id=diff-amp-performance><span class=hanchor arialabel=Anchor># </span>Diff amp performance</h2></a><p>Here is the diff amp in its current state:</p><p><img src="/quartz/Pasted image 20220710164535.png" width=auto></p><p>I have adjusted the voltage of Q5base to be at ground and then adjusted the supply voltage so that the output is centered at ground too. This required a supply voltage of -15V, but we can just decrease the resistor there later and that should be fine.</p><p><img src="/quartz/Pasted image 20220710165010.png" width=auto></p><p>Here is what LT spice says the bandwidth should be of this configuration:</p><p><img src="/quartz/Pasted image 20220710165128.png" width=auto></p><p>I don&rsquo;t know what the cause of the difference is. I&rsquo;ve been abusing these transistors a fair bit but I would be surprised if they were damaged. The output goes straight into the scope - it&rsquo;s not even loaded down by the VCO.
The 3dB bandwidth appears to be about 100KHz, so that wwould imply a capacitive loading of about 265pF, much more than plausibly exists.
The only previous result I can find in the notes is this one [here](<a href=/quartz/20220322-Look-at-that-Bode#a3250d rel=noopener class=internal-link data-src=/quartz/20220322-Look-at-that-Bode>20220322 - Look at that Bode</a>) which also says that the bandwidth should be about 1MHz. Maybe I just need to build another one then.</p><a href=#the-parable-of-the-cable><h3 id=the-parable-of-the-cable><span class=hanchor arialabel=Anchor># </span>The parable of the cable</h3></a><p>Wow.</p><p><img src="/quartz/Pasted image 20220710173416.png" width=auto></p><p>REF1 is CH4 before the cable for CH1 was connected. Now that CH1 has been connected CH1 is quite a bit lower in amplitude! This is with my several meter long BNC cable.</p><p>This calls for a VNA capacitance measurement!</p><p><img src="/quartz/Pasted image 20220710173945.png" width=auto></p><p><img src="/quartz/Pasted image 20220710173952.png" width=auto></p><p>350pF!!! Wow.
Now I gotta go measure some other cables!
My 1m long SMA cable is still a whole 100pF:</p><p><img src="/quartz/Pasted image 20220710174234.png" width=auto></p><p>Given that even the small cable is 100pF and the high output impedance of the diff amp (6kR) I think this makes probing the loop with a regular cable a no-go unfortunately.</p><p>I attached the scope probes with the clippy thing and got this bode plot:</p><p><img src="/quartz/Pasted image 20220710180751.png" width=auto></p><p>Better, certainly. Good? Questionable. I could reduce the resistor values but the varactor diode doesn&rsquo;t really need any current to speak of and so this would just waste power when it comes time to plug it into a battery.
May as well give it a shot on the real circuit anyway.</p><a href=#pll-performance-with-diff-amp><h2 id=pll-performance-with-diff-amp><span class=hanchor arialabel=Anchor># </span>PLL performance with diff amp</h2></a><p>Overall it works pretty well. Locking range is 860mV.
Input/output ocillation with maximum modulation in:</p><p><img src="/quartz/Pasted image 20220711184731.png" width=auto></p><p>Corresponding actual inputs/outputs:</p><p><img src="/quartz/Pasted image 20220711184927.png" width=auto></p><p>Noice!
Here is the above waveform saved and analysed for nonlinearities:</p><p><img src="/quartz/Pasted image 20220711190710.png" width=auto></p><p>The voltages on the varactor diodes are actually in kind of a different place which might account for some of the nonlinearity here.
Here is a 500Hz sine wave with 750mVpp modulation:</p><p><img src="/quartz/Pasted image 20220711191529.png" width=auto></p><a href=#damping><h3 id=damping><span class=hanchor arialabel=Anchor># </span>Damping:</h3></a><p>Note that when sharp edge are put in the system such as with a square wave the locking range is a fair bit lower, like 500mV instead of 1V.
Things are rather underdamped, to say the least:</p><p><img src="/quartz/Pasted image 20220711184437.png" width=auto></p><p>Maybe we can tune that later but at this point I think that things are working pretty well. Time to whip up a FET input follower so the diff amp isn&rsquo;t loaded down too much and we should be off to the races.</p></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=/quartz// data-ctx="20220710 Reference loop filter.md" data-src=/ class=internal-link>Harry dB notes</a></li><li><a href=/quartz/index_base/ data-ctx="20220710 Reference loop filter.md" data-src=/index_base class=internal-link>Harry dB notes</a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://Oscilllator.github.io/quartz/js/graph.abd4bc2af3869a96524d7d23b76152c7.js></script></div></div><div id=contact_buttons><footer><p>Made by Harry dB using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, Â© 2025</p><ul><li><a href=https://Oscilllator.github.io/quartz/>Home</a></li></ul></footer></div></div></body></html>