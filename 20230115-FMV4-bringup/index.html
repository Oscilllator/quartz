<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="The FM4V pcbs have arrived. This time I used the jlcpcb assembly service. The PCB&rsquo;s look like this: ![[Pasted image 20230115192501."><title>Harry dB notes</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=harrydb.com//icon.png><link href=/harrydb.com/styles.708c2658f93e3a9d323a1f9fded8f4b2.min.css rel=stylesheet><link href=/harrydb.com/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=/harrydb.com/js/darkmode.40a0b49e442def0e779e6472531a2a51.min.js></script>
<script src=/harrydb.com/js/util.9825137f5e7825e8553c68ce39ac9e44.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script src=/harrydb.com/js/popover.9b72b70bd35617d0635e9d15463662b2.min.js></script>
<script src=/harrydb.com/js/code-title.b35124ad8db0ba37162b886afb711cbc.min.js></script>
<script src=/harrydb.com/js/clipboard.c20857734e53a3fb733b7443879efa61.min.js></script>
<script src=/harrydb.com/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const BASE_URL="harrydb.com/",fetchData=Promise.all([fetch("/harrydb.com/indices/linkIndex.b3259f812ed133e49589f69cf23d7208.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("/harrydb.com/indices/contentIndex.b2a9f6bd184bb3f224d1460f815a9d65.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("harrydb.com",!0,!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("harrydb.com",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'â€™':"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "\/harrydb.com\/js\/router.9d4974281069e9ebb189f642ae1e3ca2.min.js"
    attachSPARouting(init, render)
  </script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-XYFD95KB4J"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XYFD95KB4J",{anonymize_ip:!1})}</script><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=/harrydb.com/js/full-text-search.24827f874defbbc6d529926cbfcfb493.min.js></script><div class=singlePage><header><h1 id=page-title><a href=harrydb.com/>Harry dB notes</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><p class=meta>Last updated
Unknown
<a href=https://github.com/jackyzha0/quartz/tree/hugo/content/20230115%20FMV4%20bringup.md rel=noopener>Edit Source</a></p><ul class=tags></ul><aside class=mainTOC><details><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#assembly-problems>Assembly problems</a></li><li><a href=#optimising>Optimising</a></li><li><a href=#input-matching>Input matching</a></li><li><a href=#impedance-measurements>Impedance measurements</a></li><li><a href=#20230415-back-in-da-game>20230415 Back in da game</a></li><li><a href=#impedance-measurements-again>Impedance measurements (again)</a></li><li><a href=#a-moment-of-attenuated-brain-function>A moment of attenuated brain function</a><ol><li><a href=#attaching-components-for-matching>Attaching components for matching.</a></li><li><a href=#some-progress>Some progress.</a></li></ol></li><li><a href=#gain-meassurements>Gain meassurements:</a></li></ol><ol><li><ol><li><a href=#small-experiment>Small experiment</a></li></ol></li><li><a href=#inductor-quality>Inductor quality</a></li><li><a href=#conclusion>Conclusion</a></li></ol></nav></details></aside><p>The FM4V pcbs have arrived. This time I used the jlcpcb assembly service. The PCB&rsquo;s look like this:
<img src="/harrydb.com/Pasted image 20230115192501.png" width=auto></p><p>The oscillator comes up without any prompting thankfully. The first thing that I want to look at is the 915MHz amplifier.
In order not to cook the spectrum analyzer I am going to use the attenuator from <a href=harrydb.com/20230115-attenuator rel=noopener class=internal-link data-src=harrydb.com/20230115-attenuator>20230115 attenuator</a>.</p><a href=#assembly-problems><h2 id=assembly-problems><span class=hanchor arialabel=Anchor># </span>Assembly problems</h2></a><p><img src="/harrydb.com/Pasted image 20230115193957.png" width=auto>
Some dingus soldered a 0R resistor onto R65 which understandably. Once that was removed the amplifier turned itself into a 700MHz oscillator. Nice. Since the VCO is right next to the amplifier I&rsquo;m going to turn it off by desoldering R53 and then trying again.
That fixed the oscillation, but there is now a bunch of crosstalk coming somewhere from the 10MHz system. The fastest edges there come from the NAND gate, and indeed the interference concides directly with an extremely sharp falling edge there. Disconnecting the phase detector by desoldering R5 gets rid of it entirely.
The amplifier has huge attenuation. Perhaps this has something to do with how someone put a 0R resistor in R64.
Removing that resistor we get this:
<img src="/harrydb.com/Pasted image 20230116113736.png" width=auto>
This is with 20dB attenuation from the attenuator, bottom line is ref through a THRU trace on the ufl RF demo kit.</p><a href=#optimising><h2 id=optimising><span class=hanchor arialabel=Anchor># </span>Optimising</h2></a><p>The BFP420 should have way more gain than this though:
<img src="/harrydb.com/Pasted image 20230116114145.png" width=auto></p><p>So let&rsquo;s measure some important parameters:</p><ul><li>Vbe = 0.951V</li><li>Ic = 2.79 / 50 = 55mA</li><li>Ib = 3.59 / 4700 = 0.76mA
&mldr;This seems like it&rsquo;s being driven rather hard.
<img src="/harrydb.com/Pasted image 20230116114826.png" width=auto>
And indeed we seem to have travelled off the end of the x axis. Absolute maximum is 60mA though and transistor doesn&rsquo;t seem to be <em>too</em> toasty, so we should be still OK.
I think I want this amplifier to have a fairly low output impedance so as to be able to drive the mixer nice and hard, and so instead of increasing R71 I will increase R57:
<img src="/harrydb.com/Pasted image 20230116120237.png" width=auto>
I think we want somewhat less than a factor of 10 less bias current, so I&rsquo;ll go with 33kR.
&mldr;aaand the transistor seems to be blown. I resoldered another one, but for future reference the current draw without the transistor attached is 91mA. Since the regulator is a linear one, any deviation from this is the current consumption of the circuit.</li></ul><p>With R57=33k and R71 still 50R the Ic is 11mA, Ib is 3.6 / 33k = 0.1mA. Looks like this was the desired Ic adjustment, but the gain looks like this now:
<img src="/harrydb.com/Pasted image 20230116151913.png" width=auto>
Which is quite a bit worse. The S11 smith says that the input impedance is 55+j20R. I&rsquo;m not sure but that sounds pretty close to 50, sufficiently close anyway that the 20dB performance gap is not explained by it.
The application note has a pretty big inductor (about 50R at the target freq) in series with the input for 50R matching though, and I also notice that the input impedance of this thing barely changes with turning the device on and off. Also the app note for &lsquo;high impedance input&rsquo; has basically the same circuit as I do, so I think there might be something fishy going on here.
&mldr;Measuring the input capacitor, it&rsquo;s 5pF. I should check the BOM that got sent out cause it sure looks like the JLCPCB people got a lot wrong here. Using a 300pF capacitor gives this input impedance (0-915MHz):
<img src="/harrydb.com/Pasted image 20230116155442.png" width=auto>
Which looks much more like the application note (high input impedance at 100MHz).</p><a href=#input-matching><h2 id=input-matching><span class=hanchor arialabel=Anchor># </span>Input matching</h2></a><p>I think that I should initially run the system at 300MHz, to be comfortably within the scopes 500MHz bandwidth.
At 300MHz the input inpedance of the amplifier is 0-128jR. <del><del>Referring to <a href=harrydb.com/20221025-antenna-tuning#50r-matching. rel=noopener class=internal-link data-src=harrydb.com/20221025-antenna-tuning>20221025 antenna tuning</a> this means:</del></del>
Adding in an inductor of ~128R cancels the impedance at 300MHz:
<img src="/harrydb.com/Pasted image 20230116173634.png" width=auto>
But that&rsquo;s not really what I want cause the impedance is wayy too large. Doing the maths in the Hagen textbook I don&rsquo;t really see how it&rsquo;s possible to match a purely imaginary impedance to a real 50R system. The imaginary bits just shuffle around. But there is an example in an
<a href="https://www.infineon.com/dgdl/Infineon-Design_Guide_for_low_noise_TR_in_FM_radio_FE-ApplicationNotes-v01_00-EN.pdf?fileId=8ac78c8c7e7124d1017f0227976a6c9d" rel=noopener>application note</a>
<img src="/harrydb.com/Pasted image 20230116173837.png" width=auto>
So I will try to assemble this and then see what I measure.
The exact transistor I am using isn&rsquo;t one of the examples, and the match is supposed to be at 100Mhz. This is what I get:</p><a href=#impedance-measurements><h2 id=impedance-measurements><span class=hanchor arialabel=Anchor># </span>Impedance measurements</h2></a><p><img src="/harrydb.com/Pasted image 20230116175258.png" width=auto>
Where the impedance cr</p><a href=#20230415-back-in-da-game><h2 id=20230415-back-in-da-game><span class=hanchor arialabel=Anchor># </span>20230415 Back in da game</h2></a><p>Back debugging things. Kick this off with the pinout of the BFP420, which I have forgotten:
<img src="/harrydb.com/Pasted image 20230415182152.png" width=auto>
The datasheet requires way too many layers of indirection to read this imo.
Also the app note makes very little sense:
<img src="/harrydb.com/Pasted image 20230415185932.png" width=auto>
Since I haven&rsquo;t actually gotten the amplifier working at all at any point and the example schematics in this app note aren&rsquo;t quite what I laid out initially I took the opportunity to whip up a pcb:
<img src="/harrydb.com/Pasted image 20230415200349.png" width=auto>
That duplicated the schematics in the app note exactly.
Here is the pcb (it got left in the etchant too long):
<img src="/harrydb.com/Pasted image 20230418190956.png" width=auto>
and here are the results for the 50R matched one (The one with Q1):
<img src="/harrydb.com/Pasted image 20230418184138.png" width=auto>
The gain (+20dB because I put 20dB of attenuation on):
<img src="/harrydb.com/Pasted image 20230418184343.png" width=auto>
This looks more or less in line with the app note, which had gains of 15-18dB with different but similar transistors.
Just like the app note the gain seems to increase with increasing vcc too, which is nice. I wonder why that is though.</p><a href=#impedance-measurements-again><h2 id=impedance-measurements-again><span class=hanchor arialabel=Anchor># </span>Impedance measurements (again)</h2></a><p>Now that we have a good starting point the time has come to try to get it to work for higher frequencies. The matching looks like this from 50-1000MHz:
<img src="/harrydb.com/Pasted image 20230418184828.png" width=auto>
So I think we are all good there. The gain looks like this:
<img src="/harrydb.com/Pasted image 20230418184850.png" width=auto></p><p>which obviously needs to be changed. Let&rsquo;s see what happens when we remove the Feedback resistor R4:
<img src="/harrydb.com/Pasted image 20230418185108.png" width=auto>
<img src="/harrydb.com/Pasted image 20230418185507.png" width=auto>
Well that seems to have improved things across the board but not by nearly enough.</p><a href=#a-moment-of-attenuated-brain-function><h2 id=a-moment-of-attenuated-brain-function><span class=hanchor arialabel=Anchor># </span>A moment of attenuated brain function</h2></a><p>The reason that the matching was so good over the whole frequency range was because the setup went vna->attenuator->amp->vna. I did this because I was avoiding damage but of course this also meant that&rsquo;s all I measured. Here&rsquo;s the real input matching:
<img src="/harrydb.com/Pasted image 20230418190719.png" width=auto>
Much more in line with what I have come to expect: egregiously bad.
One thing I just noticed in the datasheet is this:
<img src="/harrydb.com/Pasted image 20230418192158.png" width=auto>
My Ic is according to my power supply less than 1mA. So I should bump that up to 10mA. the app note says that it will be 3.5mA and the transistors aren&rsquo;t <em>that</em> different I would have though so I&rsquo;m not sure what&rsquo;s going on here.
Honestly other than providing a design that probably works I&rsquo;m getting the impression that this app note is BS for the most part. It gives zero information on how to actually do the input impedance matching, for example.
Here is the smith chart for the input to the amplifier with the inductor L1 shorted and the capacitor C1 removed:
<img src="/harrydb.com/Pasted image 20230418194400.png" width=auto>
Since C2 is 330pF and DC blocking I think this should be a valid way to measure the input impedance? I don&rsquo;t really know how to go about doing this, the textbooks don&rsquo;t really say how you measure an active device like this much.</p><a href=#attaching-components-for-matching><h3 id=attaching-components-for-matching><span class=hanchor arialabel=Anchor># </span>Attaching components for matching.</h3></a><p>Regardless the impedance is 10-j2.6R. So First off I need a 40R inductor. That&rsquo;s 40/(2<em>pi</em>900e6) = 7nH apparently. Soldering that on did not lead to much of a change. The impedance of this component directly to ground on a separate test board is this:
<img src="/harrydb.com/Pasted image 20230419192241.png" width=auto>
interestingly it basically gets the inductance right, but impedance seems to be too low. Looks like I need to roughly double that. &mdash;Record-scratch&mdash;
<img src="/harrydb.com/Pasted image 20230419192750.png" width=auto>
That&rsquo;s a dead short to ground looks like my cal is a bit off. After re-calling things stuff looks more sensible. Here is the input to the amplifier now:
<img src="/harrydb.com/Pasted image 20230423171103.png" width=auto></p><p>That&rsquo;s&mldr; not what I expected.
The smith chart changes radically when I put a finger near it. Here is what it changes into when I attach the feedback network of R4 and C6:
<img src="/harrydb.com/Pasted image 20230423173712.png" width=auto>
utterly different. The fact that the trace lies outside the smith chart I think is an indication that this is a powered circuit that is adding energy to the system.
&ndash;Record scratch++&ndash;
Jokes there was a disconnected cap. Here is the real input impedance:
<img src="/harrydb.com/Pasted image 20230423174238.png" width=auto>
Much saner.</p><a href=#some-progress><h3 id=some-progress><span class=hanchor arialabel=Anchor># </span>Some progress.</h3></a><p>I found a
<a href=https://www.will-kelsey.com/smith_chart/ rel=noopener>cool website</a> where you can put in an impedance and see how a smith chart moves it around. I added in my impedance and calculated what would be required to bring it into 50R:
<img src="/harrydb.com/Pasted image 20230423184730.png" width=auto>
It seems the component sizes required are really small!
I added just this piece of wire to the circuit:
<img src="/harrydb.com/Pasted image 20230423184928.png" width=auto>
And it did this to the smith chart!:
<img src="/harrydb.com/Pasted image 20230423184952.png" width=auto>
The S11 return loss now looks like this:
<img src="/harrydb.com/Pasted image 20230423185010.png" width=auto>
I think -10dB is really about as good as necessary here; I&rsquo;ve proved that some amount of matching is possible. Now to test the amplifer performance. This will require a 2 port cal on the vna and also I will need to put the attenuator on the output of the vna to be able to measure the gain properly.</p><a href=#gain-meassurements><h2 id=gain-meassurements><span class=hanchor arialabel=Anchor># </span>Gain meassurements:</h2></a><p>Here is the gain with the same components values as the 100MHz reference design:
<img src="/harrydb.com/Pasted image 20230423190433.png" width=auto>
I&rsquo;m assuming this looks bad from terrible output matching. From a plain no-parasitic no-nonsense reading of the schematic the amplifier should have an output impedance of R2+R3 == 100R ish which doesn&rsquo;t sound so bad. So I will remove L2 and C5 from the schematic:
<img src="/harrydb.com/Pasted image 20230423190948.png" width=auto>
This results in a gain of about 10dB at 900MHz. I added an additional 50R resistor on to the output and it dropped by about 4dB which indicates that in fact the output is in fact fairly well matched at this frequency. If the output impedance was far above 50R then it would drop by a lot, and if it was far below 50R (unlikely!) then it would drop below that. I think maybe I should be looking at the s21 phase at this point but not sure how to use that to come up with a complex output impedance.
Adding loop wires to the output like I did with the input seems to make things quite a bit worse though.
Idea: remove the negative feedback. That seemed to help a tiny bit but not much.</p><a href=#design-guide-update><h1 id=design-guide-update><span class=hanchor arialabel=Anchor># </span>Design guide update</h1></a><p>As usual I did not do a proper literature search.
<a href="https://www.infineon.com/dgdl/Infineon-Design_guide_for_RF-transistors_and_diode_in_Low-Noise-Block-ApplicationNotes-v01_00-EN.pdf?fileId=8ac78c8c7e7124d1017f01f071aa5b8f" rel=noopener>Here</a> is a reference circuit for the exact transistor that I had:
<img src="/harrydb.com/Pasted image 20230423201031.png" width=auto>
It&rsquo;s kind of gratifying to see that both I and they converged on not really having any specific impedance matching components. I also decreased R2 a bunch which is also good to see. Let&rsquo;s go ahead and switch out the components.
This is what I see (I gave up on using the attenuator):
<img src="/harrydb.com/Pasted image 20230423205232.png" width=auto>
As opposed to app note:
<img src="/harrydb.com/Pasted image 20230423205305.png" width=auto>
Gee, that&rsquo;s never happened before.
Oh wait it&rsquo;s probably compression from the VNA&rsquo;s high output amplitude. Setting 30dB of attenuation gets this:
<img src="/harrydb.com/Pasted image 20230423205544.png" width=auto>
Which is much more reasonable, but also still only 10dB of gain.
That&rsquo;s enough for today I think. I don&rsquo;t know what to try next other than a different PCB layout, but I can&rsquo;t help but think that&rsquo;s not the problem.</p><a href=#small-experiment><h3 id=small-experiment><span class=hanchor arialabel=Anchor># </span>Small experiment</h3></a><p>I tried measuring the gain with and without the supply decoupling cap and it made basically no difference. In retrospect this is not too surprising i suppose since there&rsquo;s an inductor in line with the collector of the transistor but still this is evidence I suppose that the current layout is bad.</p><a href=#inductor-quality><h2 id=inductor-quality><span class=hanchor arialabel=Anchor># </span>Inductor quality</h2></a><p>It&rsquo;s quite possible that the inductor I am using on the collector of the transistor (L1 above) does not do well at 900MHz. So I made some handwound ones. Here is a 100nH one:
<img src="/harrydb.com/Pasted image 20230427204342.png" width=auto>
Blue is handwound 150nH, normal is 30nH chip inductor.
<img src="/harrydb.com/Pasted image 20230427211024.png" width=auto>
So the inductors do seem to get a bit squiggly around 900MHz. When I attach various handwound inductors from 0 to 150nH the gain changes a tiny bit (1dB?) but not really that much.</p><a href=#conclusion><h2 id=conclusion><span class=hanchor arialabel=Anchor># </span>Conclusion</h2></a><p>Everything makes so little sense that I think I need to start from a known working example like an eval board. If even the most basic single transistor amplifier doesn&rsquo;t work something is very wrong. The infineon eval boards are all &ldquo;available on request&rdquo;. Just give me the gerbers at least!!!</p></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=harrydb.com// data-ctx="20230115 FMV4 bringup.md" data-src=/ class=internal-link>Harry dB notes</a></li><li><a href=harrydb.com/20230815-New-instrument-new-results/ data-ctx=radio data-src=/20230815-New-instrument-new-results class=internal-link></a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=/harrydb.com/js/graph.abd4bc2af3869a96524d7d23b76152c7.js></script></div></div><div id=contact_buttons><footer><p>Made by Harry dB using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, Â© 2025</p><ul><li><a href=harrydb.com/>Home</a></li></ul></footer></div></div></body></html>