<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="Main goal This fm radio project has dragged on long enough. If I could build one of those antennas with inductors at the bottom that work at low frequencies then I could avoid the planned upconverting step to 915MHz and just operate the system directly at 10MHz."><title>Harry dB notes</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://Oscilllator.github.io/quartz//icon.png><link href=https://Oscilllator.github.io/quartz/styles.708c2658f93e3a9d323a1f9fded8f4b2.min.css rel=stylesheet><link href=https://Oscilllator.github.io/quartz/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://Oscilllator.github.io/quartz/js/darkmode.9b46d81b9b161bfac149d66dfa6b3812.min.js></script>
<script src=https://Oscilllator.github.io/quartz/js/util.9825137f5e7825e8553c68ce39ac9e44.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script src=https://Oscilllator.github.io/quartz/js/popover.9b72b70bd35617d0635e9d15463662b2.min.js></script>
<script src=https://Oscilllator.github.io/quartz/js/code-title.b35124ad8db0ba37162b886afb711cbc.min.js></script>
<script src=https://Oscilllator.github.io/quartz/js/clipboard.c20857734e53a3fb733b7443879efa61.min.js></script>
<script src=https://Oscilllator.github.io/quartz/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const BASE_URL="https://Oscilllator.github.io/quartz/",fetchData=Promise.all([fetch("https://Oscilllator.github.io/quartz/indices/linkIndex.dcf24e69387ecf5812c84451d4a01d67.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://Oscilllator.github.io/quartz/indices/contentIndex.716d37a1ed15ca5f3630313c1e7dc134.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://Oscilllator.github.io/quartz",!0,!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://Oscilllator.github.io/quartz",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'â€™':"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/Oscilllator.github.io\/quartz\/js\/router.9d4974281069e9ebb189f642ae1e3ca2.min.js"
    attachSPARouting(init, render)
  </script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-XYFD95KB4J"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XYFD95KB4J",{anonymize_ip:!1})}</script><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://Oscilllator.github.io/quartz/js/full-text-search.24827f874defbbc6d529926cbfcfb493.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://Oscilllator.github.io/quartz/>Harry dB notes</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><p class=meta>Last updated
Unknown
<a href=https://github.com/jackyzha0/quartz/tree/hugo/content/20221025%20antenna%20tuning.md rel=noopener>Edit Source</a></p><ul class=tags></ul><aside class=mainTOC><details><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#initial-tests>Initial tests</a></li><li><a href=#measuring-real-antenna-impedance>Measuring real antenna impedance</a><ol><li><a href=#scrounging-about-for-inductors-again>Scrounging about for inductors (again):</a></li></ol></li><li><a href=#transmission-between-antennas>Transmission between antennas</a><ol><li><a href=#sitting-next-to-each-other>Sitting next to each other:</a></li></ol></li><li><a href=#2m-away>2m away</a><ol><li><a href=#50r-matching>50R matching.</a></li><li><a href=#the-next-day>The next day&mldr;</a></li></ol></li><li><a href=#915mhz-antenna>&ldquo;915MHz&rdquo; antenna.</a></li></ol></nav></details></aside><a href=#main-goal><h1 id=main-goal><span class=hanchor arialabel=Anchor># </span>Main goal</h1></a><p>This fm radio project has dragged on long enough. If I could build one of those antennas with inductors at the bottom that work at low frequencies then I could avoid the planned upconverting step to 915MHz and just operate the system directly at 10MHz. Not particularly FCC compliant, but for desk->headphone transmission the power should be low enough that it&rsquo;s OK.</p><a href=#initial-tests><h2 id=initial-tests><span class=hanchor arialabel=Anchor># </span>Initial tests</h2></a><p>I stuck a piece of wire to a pcb like so:
<img src="/quartz/Pasted image 20221025203615.png" width=auto>
The S11 return loss looks like this:
<img src="/quartz/Pasted image 20221025203639.png" width=auto>
with a minimum at 612MHz, which sounds about right. -25dB means that 95% of the energy gets transmitted I think.
Adding a 10nH inductor to the base makes it look like this (I changed the settings):
<img src="/quartz/Pasted image 20221025203909.png" width=auto>
it dropped the frequency a bit, but not by that much!
Time to 10x the inductor. 100nH looks like this:
<img src="/quartz/Pasted image 20221025204223.png" width=auto>
still not even close to being low frequency enough, and the transmission has dropped to like 6dB / 50% of the energy.
I&rsquo;ve heard that there&rsquo;s this thing called &ldquo;impedance matching&rdquo; that you are supposed to do too, so I added a 5pF cap to ground like so:
<img src="/quartz/Pasted image 20221025212908.png" width=auto>
Which results in this:
<img src="/quartz/Pasted image 20221025212939.png" width=auto>
Pretty nice!
Cut-and-try seems like a bad policy here, even if the state space is really small. You are supposed to like balance the the capacitance with the reactance, or something. Now for the question of how much &ldquo;capacitance&rdquo; equals how much &ldquo;reactance&rdquo;.
Surely this can be measured with a VNA!
<img src="/quartz/Pasted image 20221025213523.png" width=auto>
I believe on the smith chart where the trace crosses the horizontal axis is where the impedance is purely real (what we want, I think). This is actually pretty close already to the best S11 loss (denoted by the red 1). Deviations along the horizontal axis are away from 50R but I don&rsquo;t think we care about that so much since we are making our own amplifier anyway.
Time for our first hypothesis: since the red 1 is in the inductive half, we want to add some more capacitance to bring it towards the capacitive half!
<img src="/quartz/Pasted image 20221025213842.png" width=auto>
<img src="/quartz/Pasted image 20221025213854.png" width=auto>
I am a tuning genius.</p><a href=#measuring-real-antenna-impedance><h2 id=measuring-real-antenna-impedance><span class=hanchor arialabel=Anchor># </span>Measuring real antenna impedance</h2></a><p>To calculate the matching network I think we need to measure the antenna impedance at our target frequency. This will be approximately infinity ohms I think.
<img src="/quartz/Pasted image 20221025215046.png" width=auto>
This is the R+Jx impedance plot from 1-20MHz. at 10Mhz it&rsquo;s basically NaN - 3.2kR. Does that mean that I need an inductor that&rsquo;s Z=3.2kR at 10MHz? without bothering to actually look the answer up I&rsquo;m going to go ahead an say yes!
So according to $X_l = 2Ï€fL$ that means my inductor should be 3200/(2<em>pi</em>10e6) = 50uH. That sounds&mldr; reasonable?
And then I think I&rsquo;ll need to add a capacitor in order to match the impedances to the output of my amplifier. Maybe.</p><a href=#scrounging-about-for-inductors-again><h3 id=scrounging-about-for-inductors-again><span class=hanchor arialabel=Anchor># </span>Scrounging about for inductors (again):</h3></a><p>Here is a promising inductor 100uH that I could have had two of in parallel:
<img src="/quartz/Pasted image 20221025223441.png" width=auto>
SRF is 7MHz though :(
Stacking 5 of a <a href=/quartz/20220701-Inductance-measurements#80ed77 rel=noopener class=internal-link data-src=/quartz/20220701-Inductance-measurements>Previous resistor</a> (AIML-0603-100K-T0 in series gives this:
<img src="/quartz/Pasted image 20221025223917.png" width=auto>
<img src="/quartz/Pasted image 20221025224029.png" width=auto>
Honestly I don&rsquo;t see why people call antenna design hard, this is all going according to plan. Suspiciously so, in fact.
Since our antenna is basically an open circuit, I think adding a 2.3kR capacitor might be what is required. That&rsquo;s a 1/(2*pi*2.3e3*10e6) = 7pF capacitor. Since we are adding all these whopping great inductors in I kinda expected something bigger, but OK.
<img src="/quartz/Pasted image 20221025224446.png" width=auto>
welp that just moved the resonant frequency down to 9.8MHz and did nothing to the S11. Not that surprising really.
As a sanity check I removed the actual antenna to make sure that it was having an effect. Here is an A/B:
<img src="/quartz/Pasted image 20221026080931.png" width=auto>
Seems like it is the inductor!</p><a href=#transmission-between-antennas><h2 id=transmission-between-antennas><span class=hanchor arialabel=Anchor># </span>Transmission between antennas</h2></a><p>To really check if the antennas are doing something and I don&rsquo;t just have some loss at a certain frequency I think the best thing to do is make two of the same antennas and transmit between them. here is an initial attempt:
<img src="/quartz/Pasted image 20221026083020.png" width=auto>
&mldr;Not great, but not too hard to adjust I would think.
Turns out just having the antenna on vs off the desk can make this much difference:
<img src="/quartz/Pasted image 20221026083608.png" width=auto></p><a href=#sitting-next-to-each-other><h3 id=sitting-next-to-each-other><span class=hanchor arialabel=Anchor># </span>Sitting next to each other:</h3></a><p><img src="/quartz/Pasted image 20221026084735.png" width=auto>
<img src="/quartz/Pasted image 20221026084556.png" width=auto>
<img src="/quartz/Pasted image 20221026084605.png" width=auto>
&lt;10dB of loss seems crazy good tbh. There&rsquo;s also clearly a split in the S11 return loss peak so the antennas are influencing each other.</p><a href=#2m-away><h2 id=2m-away><span class=hanchor arialabel=Anchor># </span>2m away</h2></a><p><img src="/quartz/Pasted image 20221027213706.png" width=auto>
<img src="/quartz/Pasted image 20221027213713.png" width=auto>
S21 looks quite good but the S11 is clearly bad (should never be positive for a passive device!) and so perhaps it can&rsquo;t be trusted.
Regardless I think we can try and transform the impedances now. The impedance of the antenna at the resonance point is acctualy quite real, 216+4.3JR. I suppose that&rsquo;s energy transmission requires a real impedance.</p><a href=#50r-matching><h3 id=50r-matching><span class=hanchor arialabel=Anchor># </span>50R matching.</h3></a><p>Appendix H of the art of electronics is a good help here:
<img src="/quartz/Pasted image 20221027214020.png" width=auto>
Matching to a 50R system means that our Qel is sqrt(200/50 - 1) = 1.73. So our inductor value should have an impedance of 200 / 1.73 = 113R. That means the value is 113/(2*pi*10e6) = 1.79uH.
Then we should have a capacitor with impedance 50 * 1.73 = 86.5R, or 183pF.
Let&rsquo;s try it out!
I used two 910nH inductors in series and a 180pF capacitor to get this plot:
<img src="/quartz/Pasted image 20221028182452.png" width=auto>
With an impedance of:
<img src="/quartz/Pasted image 20221028182515.png" width=auto>
Absolutely spot on. Very high Q though.</p><a href=#the-next-day><h3 id=the-next-day><span class=hanchor arialabel=Anchor># </span>The next day&mldr;</h3></a><p>I come back the next day and measure this:
<img src="/quartz/Pasted image 20221028182606.png" width=auto>
49.9+6JR.
It seems like the resonant frequency moved by about 1MHz overnight, and the Q dropped as a result too!
I don&rsquo;t know why this would be. Taking the antenna off the bench and leaving it free hanging gives this plot:
<img src="/quartz/Pasted image 20221028182805.png" width=auto>
Where the reference is on the bench and the poper measurement is off it.
This is terrible! The antenna bandwidth is going to shift around so much based on what it&rsquo;s sitting next to the entire passband will move away!
Regardless let&rsquo;s proceed with matching the other antenna and see if we get better transmission anyway.
&mldr;And after messing about with variable inductors trying to get things to line up I realise that it isn&rsquo;t really possible to make a useable system with this. Tolerances in components and how the antenna is situated with respect to the other antennas etc just make too much difference. This is my first time measuring an antenna though so I shall go and make a proper 1/4 wavelength 915MHz antenna and see how sensitive that is to the environment.</p><a href=#915mhz-antenna><h2 id=915mhz-antenna><span class=hanchor arialabel=Anchor># </span>&ldquo;915MHz&rdquo; antenna.</h2></a><p>The antenna looks like this:
<img src="/quartz/Pasted image 20221029174430.png" width=auto>
And has an S11 that looks like this:
<img src="/quartz/Pasted image 20221029174451.png" width=auto>
Where the two traces are with/without hand.
This is the smith chart:
<img src="/quartz/Pasted image 20221029174520.png" width=auto>
Overall this has made me thoroughly disillusioned with the whole antenna thing. Maybe consumer grade antennas are designed to be especially wideband to let in frequencies no matter how close/far the unit is to the meatbag? Unclear.</p></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=/quartz// data-ctx="20221025 antenna tuning.md" data-src=/ class=internal-link>Harry dB notes</a></li><li><a href=/quartz/20221103-915MHz-brrr/ data-ctx=previous data-src=/20221103-915MHz-brrr class=internal-link></a></li><li><a href=/quartz/20230115-FMV4-bringup/ data-ctx="20221025 antenna tuning#50R matching." data-src=/20230115-FMV4-bringup class=internal-link></a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://Oscilllator.github.io/quartz/js/graph.abd4bc2af3869a96524d7d23b76152c7.js></script></div></div><div id=contact_buttons><footer><p>Made by Harry dB using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, Â© 2024</p><ul><li><a href=https://Oscilllator.github.io/quartz/>Home</a></li></ul></footer></div></div></body></html>