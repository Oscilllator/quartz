<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="I bought an Agilent 6675A power supply for $40. 110V 18A supply, tremendous.
I plugged it in, set the voltage to 10V."><title>Harry dB notes</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://Oscilllator.github.io/quartz//icon.png><link href=https://Oscilllator.github.io/quartz/styles.708c2658f93e3a9d323a1f9fded8f4b2.min.css rel=stylesheet><link href=https://Oscilllator.github.io/quartz/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://Oscilllator.github.io/quartz/js/darkmode.9b46d81b9b161bfac149d66dfa6b3812.min.js></script>
<script src=https://Oscilllator.github.io/quartz/js/util.9825137f5e7825e8553c68ce39ac9e44.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script src=https://Oscilllator.github.io/quartz/js/popover.9b72b70bd35617d0635e9d15463662b2.min.js></script>
<script src=https://Oscilllator.github.io/quartz/js/code-title.b35124ad8db0ba37162b886afb711cbc.min.js></script>
<script src=https://Oscilllator.github.io/quartz/js/clipboard.c20857734e53a3fb733b7443879efa61.min.js></script>
<script src=https://Oscilllator.github.io/quartz/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const BASE_URL="https://Oscilllator.github.io/quartz/",fetchData=Promise.all([fetch("https://Oscilllator.github.io/quartz/indices/linkIndex.fac36dfbeb195a5f4036317fa199e2e1.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://Oscilllator.github.io/quartz/indices/contentIndex.446962f6c2c0ec7bee6a6258333d7feb.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://Oscilllator.github.io/quartz",!0,!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://Oscilllator.github.io/quartz",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'’':"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/Oscilllator.github.io\/quartz\/js\/router.9d4974281069e9ebb189f642ae1e3ca2.min.js"
    attachSPARouting(init, render)
  </script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-XYFD95KB4J"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XYFD95KB4J",{anonymize_ip:!1})}</script><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://Oscilllator.github.io/quartz/js/full-text-search.24827f874defbbc6d529926cbfcfb493.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://Oscilllator.github.io/quartz/>Harry dB notes</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><p class=meta>Last updated
Unknown
<a href=https://github.com/jackyzha0/quartz/tree/hugo/content/20240321%20Agilent%206675A.md rel=noopener>Edit Source</a></p><ul class=tags></ul><aside class=mainTOC><details><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#things-floating-at-mains>Things floating at mains</a></li><li><a href=#road-to-success>Road to success</a></li><li><a href=#bad-fmax>Bad fmax</a></li><li><a href=#more-comparisons>More comparisons</a></li><li><a href=#and-now-for-a-very-confusing-graph>And now, for a very confusing graph:</a></li><li><a href=#cleanup-encoder>Cleanup: encoder</a></li></ol></nav></details></aside><p>I bought an Agilent 6675A power supply for $40. 110V 18A supply, tremendous.</p><p>I plugged it in, set the voltage to 10V. Got 10V, nice. I changed the voltage to 110V and then got this:</p><p><img src="/quartz/Pasted image 20240321210305.png" width=auto></p><p>&mldr;not so nice. This is the schematic of the above board with what I think blew up crossed out:</p><p><img src="/quartz/Pasted image 20240321210354.png" width=auto></p><p>&mldr;so that&rsquo;s not great. I purchased a replacement MOSFET driver and a not-quite-replacement npn transistor (TIP42C), then reconnected everything and turned it back on. It turns on and I can set the voltage and current, but the front panel says &lsquo;Unr&rsquo; which according to the manual means &ldquo;unregulated&rdquo;. Further investigation revealed that the input 240V 20A fuse had blown, so I replaced it with some 0.2mm copper wire, which apparently has a fusing current of like 6A.</p><p>After turning on the supply it seemed happier. I changed the voltage to 6V and the power supply said it was in constant voltage mode instead of unregulated mode, nice! Then I turned around to grab the multimeter and the fuse wire I put in absolutely <em>detonated</em> with a loud bang. Not a pop. A bang. This is what the surrounding area looked like afterwards:</p><p><img src="/quartz/Pasted image 20240321210829.png" width=auto></p><p>&mldr;That is a little unnerving. I quickly got out the thermal camera after it went pop to try and catch something red handed, but no luck. Rather than put a piece of wire back and try it all again, I instead went back to the FET board above looking for trouble. This time the pnp Q252 driving the low side FET died. Oh and by the way, the schematic is not the schematic for the board that I have. It&rsquo;s for a later revision of the board that uses MOSFET&rsquo;s rather than IGBT&rsquo;s. Taking the pnp transistor out I see it has failed short.</p><p>&mldr;Looking at the datasheet for the replacement transistor I got I observe that it has a transition frequency of 3MHz, whereas the originals (according to the schematic, anyway) have a transistion frequency of 80MHz. Given that they were driving the top and bottom of a half bridge, the chances of shoot through are approximately 100%. So I&rsquo;ve ordered a full set of replacement pnp&rsquo;s for 3/4 of the price of the entire power supply.</p><a href=#things-floating-at-mains><h2 id=things-floating-at-mains><span class=hanchor arialabel=Anchor># </span>Things floating at mains</h2></a><p>The entire FET board is floating at mains. I don&rsquo;t know that it&rsquo;s supposed to do that. It certainly makes probing the board more annoying, this is what happens when I touch the ground lead of my scope to the &ldquo;ground&rdquo; of the FET board:</p><p><img src="/quartz/Pasted image 20240322200918.png" width=auto></p><p>&mldr;fzzzt.</p><p>This is is the mains input board of the supply:</p><p><img src="/quartz/Pasted image 20240322201115.png" width=auto></p><p>So you can see that the system before the rectifying diode is actually at +/- 110 with respect to the chassis. There is a 10k resistor to the chassis on the FET board:</p><p><img src="/quartz/Pasted image 20240322201542.png" width=auto></p><p>That is sits at 170C according to the thermal camera. $220^2/10e3 = 4.8W$. That seems about right for the temperature, but surely the designers of the supply did not intend for -RAIL to be floating so high, given how they tied it to ground.</p><p>&mldr;It turns out that the heatsink is not supposed to sit at ground at all, and that the big plasic clips that hold it in aren&rsquo;t just there to annoy me but in fact serve to float the whole board. The addition of a printer filament box between the heatsink and chassis drops R258&rsquo;s temperature admirably:</p><p><img src="/quartz/Pasted image 20240412200658.png" width=auto></p><p>In order to be able to probe things whilst not being electrocuted I also swapped out the recified mains DC output for a bench supply output of 20V.</p><a href=#road-to-success><h2 id=road-to-success><span class=hanchor arialabel=Anchor># </span>Road to success</h2></a><a href=#bad-fmax><h2 id=bad-fmax><span class=hanchor arialabel=Anchor># </span>Bad fmax</h2></a><p>The
<a href=https://www.onsemi.com/pdf/datasheet/tip42c-d.pdf rel=noopener>TIP42C</a> transistors that I purchased have a gain bandwidth product of 3MHz:</p><p><img src="/quartz/Pasted image 20240412200101.png" width=auto></p><p>but the original
<a href=https://assets.nexperia.com/documents/data-sheet/MJD45H11.pdf rel=noopener>MJD45H11</a> transistors have a transition frequency of 80MHz:</p><p><img src="/quartz/Pasted image 20240412200208.png" width=auto></p><p>&mldr;This would seem to be an issue. So I bought some
<a href=https://www.digikey.com/en/products/detail/sanken-electric-usa-inc/2SA1186/3661800 rel=noopener>2SA1186</a> ones instead which have a transition frequency of 60MHz, which is hopefully good enough.</p><a href=#more-comparisons><h2 id=more-comparisons><span class=hanchor arialabel=Anchor># </span>More comparisons</h2></a><p>In preparation for the above transistors arriving I took all the existing ones off the board, and then started probing about to find further differences between the two sides of the circuit. I discovered that the side with the blown PNP transistor also had some bad power transistors:</p><p><img src="/quartz/Pasted image 20240412201057.png" width=auto></p><p>And in addition to that the FET driver that originally died and that I replaced had died again, so I replaced that for a second time also.</p><p>All of this was made possible by comparing the two symmetrical sides of the circuit and comparing waveforms to help reason it out. Without that reference to look at I think this would have taken far too long to figure out and wouldn&rsquo;t have been worth doing.</p><p>Unlike what you might expect from looking in the schematic of the manual, the supply actually has two sets of FET&rsquo;s in parallel:</p><p><img src="/quartz/Pasted image 20240412201410.png" width=auto></p><p>So I took some working FET&rsquo;s from side B and put them on side A. In total two of the FET&rsquo;s of side A were completely kaput and one of them was functioning merely poorly (the waveform didn&rsquo;t look idential with the other side). After replacing all 3, I got a regulated output voltage!
The power board was being supplied with 20V and doesn&rsquo;t seem to want to go above 5.5V or so but I think that&rsquo;s OK and should be fixed when I switch back to mains. This regulated voltage was actually achieved without the pnp transistors at all:</p><p><img src="/quartz/Pasted image 20240412202056.png" width=auto></p><p>So I guess they are just there to speed up the edges. I also think that it would be best to add them before actually drawing any load from the supply.</p><a href=#and-now-for-a-very-confusing-graph><h2 id=and-now-for-a-very-confusing-graph><span class=hanchor arialabel=Anchor># </span>And now, for a very confusing graph:</h2></a><p>OK so it turns out what looks too good to be true is. Even though the output is being correctly regulated, there is still something clearly wrong with the FET driving still:
<img src="/quartz/Pasted image 20240412212612.png" width=auto></p><p>The high side gate of the side of the schematic that has components blowing up is still clearly not being driven correctly for some reason. The &ldquo;high side gate(bad)&rdquo; clearly shows this, it is not capable of drivin up to the same as the high side gate on the other side. Here is what the half bridge midpoint looks like:</p><p><img src="/quartz/Pasted image 20240412212848.png" width=auto></p><p>So if you take the yellow trace in the top plot - the yellow trace in the bottom plot you get the Vgs of the top FET. and clearly the source of the FET is not floating up to any rail at the time that the high side gate goes high. So perhaps this FET is also dead and not conducting? I do have one more spare power FET, so let&rsquo;s try that.</p><p><img src="/quartz/Pasted image 20240413114519.png" width=auto></p><p>&mldr; There we go. I suppose in retrospect it should have been surprising that 3 out of 4 FET&rsquo;s on a half bridge would fail. But I was fooled because some of them failed short circuit and some failed open circuit. After replacing that last FET everything seemed fine so I put the FET board back on the mains power and nothing blew up. As far as I can tell that means that the unit is working!</p><a href=#cleanup-encoder><h2 id=cleanup-encoder><span class=hanchor arialabel=Anchor># </span>Cleanup: encoder</h2></a><p>The two encoder wheels on the front had gotten banged and the knobs popped off:</p><p><img src="/quartz/Pasted image 20240413142738.png" width=auto></p><p>Inside the encoders look like this:</p><p><img src="/quartz/Pasted image 20240413142940.png" width=auto></p><p><img src="/quartz/Pasted image 20240413142954.png" width=auto></p><p>The actual wheel is a very solid piece of metal, basically looks like a motor stator. Seems kind of gratuitous to be honest, but then again the encoders survived the 7mm ABS shaft being snapped off, so what do I know?</p><a href=#the-saga-continues><h1 id=the-saga-continues><span class=hanchor arialabel=Anchor># </span>The saga continues</h1></a><p>I just <a href=/quartz/20240424-Plasma-toroid-3-Aluminium rel=noopener class=internal-link data-src=/quartz/20240424-Plasma-toroid-3-Aluminium>blew up</a> the supply again. How annoying. This time it seems that both the regulator and the half bridge are dead:</p><p><img src="/quartz/Pasted image 20240425211644.png" width=auto></p><p>I think that this is the reason the 3.3R resistor was so hot. There was a short through the failed FET driver.</p><p><img src="/quartz/Pasted image 20240425211715.png" width=auto></p><p>I have ordered some replacement</p></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=/quartz// data-ctx="20240321 Agilent 6675A.md" data-src=/ class=internal-link>Harry dB notes</a></li><li><a href=/quartz/20240424-Plasma-toroid-3-Aluminium/ data-ctx='brand spanking "new"' data-src=/20240424-Plasma-toroid-3-Aluminium class=internal-link></a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://Oscilllator.github.io/quartz/js/graph.abd4bc2af3869a96524d7d23b76152c7.js></script></div></div><div id=contact_buttons><footer><p>Made by Harry dB using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, © 2024</p><ul><li><a href=https://Oscilllator.github.io/quartz/>Home</a></li></ul></footer></div></div></body></html>